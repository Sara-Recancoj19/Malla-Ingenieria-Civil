<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Malla Curricular – Ingeniería Civil</title>

<style>
:root{
  --approved:#e53935;
  --available:#ffd6d6;
  --locked:#9a9a9a;
  --obligatorio:#ffd54f;
}

body{
  font-family:system-ui, Arial;
  margin:16px;
  background:#f7fafc;
}

/* ===== HEADER ===== */
header{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:12px;
}

h1{font-size:18px;margin:0}

.counter{
  background:#fff;
  padding:8px 12px;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.08);
  font-size:13px;
}

.counter strong{font-size:16px}

/* ===== LEYENDA ===== */
.legend{
  display:flex;
  gap:14px;
  align-items:center;
  flex-wrap:wrap;
  font-size:12px;
  color:#444;
}

.legend-item{
  display:flex;
  align-items:center;
  gap:5px;
}

.color-box{
  width:12px;
  height:12px;
  border-radius:3px;
}

.badge{
  background:var(--obligatorio);
  font-size:10px;
  padding:1px 5px;
  border-radius:6px;
  font-weight:600;
}

/* ===== GRID ===== */
.grid{
  margin-top:18px;
  display:flex;
  gap:12px;
  overflow-x:auto;
}

.sem{
  min-width:240px;
  background:#fff;
  border-radius:10px;
  padding:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.06);
}

.sem h3{
  text-align:center;
  font-size:14px;
  margin:6px 0 10px;
}

.course{
  padding:8px;
  border-radius:8px;
  margin-bottom:8px;
  font-size:13px;
}

.aprobado{background:var(--approved);color:white;cursor:pointer}
.disponible{background:var(--available);cursor:pointer}
.bloqueado{background:var(--locked);color:white;cursor:not-allowed}

.meta{
  font-size:11px;
  display:flex;
  justify-content:space-between;
  margin-top:4px;
}
</style>
</head>

<body>

<header>
  <div class="top">
    <h1>Malla Curricular Interactiva – Ingeniería Civil</h1>
    <div class="counter">
      Créditos: <strong><span id="aprobados">0</span> / <span id="totales">0</span></strong>
    </div>
  </div>

  <!-- LEYENDA SUPERIOR -->
  <div class="legend">
    <div class="legend-item">
      <span class="color-box" style="background:var(--approved)"></span>
      <span>Aprobado</span>
    </div>
    <div class="legend-item">
      <span class="color-box" style="background:var(--available)"></span>
      <span>Disponible</span>
    </div>
    <div class="legend-item">
      <span class="color-box" style="background:var(--locked)"></span>
      <span>Bloqueado</span>
    </div>
    <div class="legend-item">
      <span class="badge">⭐</span>
      <span>Curso obligatorio</span>
    </div>
  </div>
</header>

<div class="grid" id="grid"></div>

<script>
const STORAGE_KEY = "malla_civil_aprobados";

const obligatorios = new Set([
"3005","3003","3000","3001","3004","3011","3006","3007",
"3161","3162","3013","3014","3163","3164"
]);

const cursos = [
{"codigo":"3005","nombre":"Técnicas de Estudio e Investigación","creditos":3,"prereq":[],"semestre":1},
{"codigo":"3003","nombre":"Área Social Humanística 1","creditos":3,"prereq":[],"semestre":1},
{"codigo":"3000","nombre":"Área Matemática Básica 1","creditos":9,"prereq":[],"semestre":1},
{"codigo":"3001","nombre":"Química General 1","creditos":7,"prereq":[],"semestre":1},
{"codigo":"3004","nombre":"Área Técnica Complementaria 1","creditos":4,"prereq":[],"semestre":1},

{"codigo":"3011","nombre":"Área Social Humanística 2","creditos":3,"prereq":["3003"],"semestre":2},
{"codigo":"3006","nombre":"Matemática Básica 2","creditos":9,"prereq":["3000"],"semestre":2},
{"codigo":"3007","nombre":"Física Básica","creditos":5,"prereq":["3000"],"semestre":2},
{"codigo":"3161","nombre":"Química para Ingeniería Civil","creditos":6,"prereq":["3001","3000"],"semestre":2},
{"codigo":"3162","nombre":"Dibujo Constructivo","creditos":6,"prereq":["3004"],"semestre":2},

{"codigo":"3013","nombre":"Matemática Intermedia 1","creditos":9,"prereq":["3006"],"semestre":3},
{"codigo":"3014","nombre":"Física 1","creditos":5,"prereq":["3006","3007"],"semestre":3},
{"codigo":"3163","nombre":"Ecología","creditos":4,"prereq":["3161"],"semestre":3},
{"codigo":"3164","nombre":"Prácticas Iniciales","creditos":0,"prereq":["3006","3162","3007"],"semestre":3}
];

let aprobados = new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"));

const totalCreditos = cursos.reduce((s,c)=>s+c.creditos,0);
document.getElementById("totales").textContent = totalCreditos;

function puedeLlevar(c){
  return c.prereq.every(p => aprobados.has(p));
}

function render(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  let suma = 0;

  const semestres = [...new Set(cursos.map(c=>c.semestre))].sort((a,b)=>a-b);

  semestres.forEach(sem=>{
    const col = document.createElement("div");
    col.className = "sem";
    col.innerHTML = `<h3>Semestre ${sem}</h3>`;

    cursos.filter(c=>c.semestre===sem).forEach(c=>{
      let estado = "bloqueado";
      if (aprobados.has(c.codigo)) estado = "aprobado";
      else if (puedeLlevar(c)) estado = "disponible";

      const div = document.createElement("div");
      div.className = `course ${estado}`;
      div.innerHTML = `
        <strong>${c.codigo}</strong> ${c.nombre}
        <div class="meta">
          <span>${c.creditos} cr</span>
          ${obligatorios.has(c.codigo)?'<span class="badge">⭐</span>':''}
        </div>
      `;

      if (estado !== "bloqueado") {
        div.onclick = () => {
          aprobados.has(c.codigo) ? aprobados.delete(c.codigo) : aprobados.add(c.codigo);
          localStorage.setItem(STORAGE_KEY, JSON.stringify([...aprobados]));
          render();
        };
      }

      if (aprobados.has(c.codigo)) suma += c.creditos;
      col.appendChild(div);
    });

    grid.appendChild(col);
  });

  document.getElementById("aprobados").textContent = suma;
}

render();
</script>

</body>
</html>
