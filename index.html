<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Malla Curricular – Ingeniería Civil</title>

<style>
:root{
  --approved:#e53935;
  --available:#ffd6d6;
  --locked:#9a9a9a;
  --obligatorio:#ffd54f;
}

body{
  font-family:system-ui, Arial;
  margin:16px;
  background:#f7fafc;
}

/* ===== HEADER ===== */
header{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:12px;
}

h1{font-size:18px;margin:0}

.counter{
  background:#fff;
  padding:8px 12px;
  border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.08);
  font-size:13px;
}

.counter strong{font-size:16px}

/* ===== LEYENDA ===== */
.legend{
  display:flex;
  gap:14px;
  align-items:center;
  flex-wrap:wrap;
  font-size:12px;
  color:#444;
}

.legend-item{
  display:flex;
  align-items:center;
  gap:5px;
}

.color-box{
  width:12px;
  height:12px;
  border-radius:3px;
}

.badge{
  background:var(--obligatorio);
  font-size:10px;
  padding:1px 5px;
  border-radius:6px;
  font-weight:600;
}

/* ===== GRID ===== */
.grid{
  margin-top:18px;
  display:flex;
  gap:12px;
  overflow-x:auto;
}

.sem{
  min-width:240px;
  background:#fff;
  border-radius:10px;
  padding:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.06);
}

.sem h3{
  text-align:center;
  font-size:14px;
  margin:6px 0 10px;
}

.course{
  padding:8px;
  border-radius:8px;
  margin-bottom:8px;
  font-size:13px;
}

.aprobado{background:var(--approved);color:white;cursor:pointer}
.disponible{background:var(--available);cursor:pointer}
.bloqueado{background:var(--locked);color:white;cursor:not-allowed}

.meta{
  font-size:11px;
  display:flex;
  justify-content:space-between;
  margin-top:4px;
}
</style>
</head>

<body>

<header>
  <div class="top">
    <h1>Malla Curricular Interactiva – Ingeniería Civil</h1>
    <div class="counter">
      Créditos: <strong><span id="aprobados">0</span> / <span id="totales">0</span></strong>
    </div>
  </div>

  <div class="legend">
    <div class="legend-item">
      <span class="color-box" style="background:var(--approved)"></span> Aprobado
    </div>
    <div class="legend-item">
      <span class="color-box" style="background:var(--available)"></span> Disponible
    </div>
    <div class="legend-item">
      <span class="color-box" style="background:var(--locked)"></span> Bloqueado
    </div>
    <div class="legend-item">
      <span class="badge">⭐</span> Obligatorio
    </div>
  </div>
</header>

<div class="grid" id="grid"></div>

<script>
const STORAGE_KEY = "malla_civil_aprobados";

/* ===== OBLIGATORIOS (CIVIL) ===== */
const obligatorios = new Set([
  "3005","3003","3000","3001","3004","3011","3006","3007",
  "3013","3014","3166","3021","3022","3025","3090","3167",
  "3170","3031","3171","3172","3028","3040","3181","3182",
  "3183","3186","3187","3188","3189","3194","3195","3197",
  "3198","3200","3202","3203","3204","3206","3208","3209",
  "3211","3214","3215","3216","3218","3219","3221","3223"
]);

/* ===== CURSOS ===== */
const cursos = [
  {"codigo":"3005","nombre":"Técnicas de Estudio e Investigación","creditos":3,"prereq":[],"semestre":1},
  {"codigo":"3003","nombre":"Área Social Humanística 1","creditos":3,"prereq":[],"semestre":1},
  {"codigo":"3000","nombre":"Área Matemática Básica 1","creditos":9,"prereq":[],"semestre":1},
  {"codigo":"3001","nombre":"Química General 1","creditos":7,"prereq":[],"semestre":1},
  {"codigo":"3004","nombre":"Área Técnica Complementaria 1","creditos":4,"prereq":[],"semestre":1},
  {"codigo":"3082","nombre":"Deportes 1","creditos":2,"prereq":[],"semestre":1},

  {"codigo":"3011","nombre":"Área Social Humanística 2","creditos":3,"prereq":["3003"],"semestre":2},
  {"codigo":"3006","nombre":"Matemática Básica 2","creditos":9,"prereq":["3000"],"semestre":2},
  {"codigo":"3007","nombre":"Física Básica","creditos":5,"prereq":["3000"],"semestre":2},
  {"codigo":"3161","nombre":"Química para Ingeniería Civil","creditos":6,"prereq":["3001","3000"],"semestre":2}, 
  {"codigo":"3162","nombre":"Dibujo Costructivo para Ingeniería","creditos":6,"prereq":["3004"],"semestre":2},
  
  {"codigo":"3013","nombre":"Área Matemática Intermedia 1","creditos":9,"prereq":["3006"],"semestre":3},
  {"codigo":"3014","nombre":"Física 1","creditos":5,"prereq":["3006","3007"],"semestre":3},
  {"codigo":"3163","nombre":"Ecología","creditos":4,"prereq":["3161"],"semestre":3}, 
  {"codigo":"3164","nombre":"Prácticas Iniciales","creditos":0,"prereq":["3006","3162","3007"],"semestre":3},
  {"codigo":"3019","nombre":"Ética Profesional","creditos":2,"prereq":["3007"],"semestre":3}, 
  {"codigo":"3089","nombre":"Logica","creditos":1,"prereq":["3011"],"semestre":3}, 
  {"codigo":"3036","nombre":"Filosofia de la ciencia","creditos":1,"prereq":["3011"],"semestre":3}, 
  
  {"codigo":"3166","nombre":"Topografía 1","creditos":7,"prereq":["3013", "3162"],"semestre":4},
  {"codigo":"3021","nombre":"Área Matemática Intermedia 2","creditos":6,"prereq":["3013"],"semestre":4}, 
  {"codigo":"3022","nombre":"Área Matemática Intermedia 3","creditos":6,"prereq":["3013"],"semestre":4}, 
  {"codigo":"3025","nombre":"Mecánica Analítica 1","creditos":4,"prereq":["3013","3014"],"semestre":4}, 
  {"codigo":"3090","nombre":"Estadística 1","creditos":5,"prereq":["3013","3005"],"semestre":4}, 
  {"codigo":"3167","nombre":"Geología","creditos":4,"prereq":["3163","3014"],"semestre":4}, 
  {"codigo":"3023","nombre":"Física 2","creditos":6,"prereq":["3013","3013"],"semestre":4}, 
  {"codigo":"3087","nombre":"Legislación 1", "creditos": 3, "prereq": ["3011"], "semestre": 4}, 
  {"codigo":"3169","nombre":"Introducción a la Ingeniería Petrolera", "creditos": 3, "prereq": ["3013","3014"], "semestre": 4},
  
  {"codigo":"3170","nombre":"Topografía 2","creditos":7,"prereq":["3166"],"semestre":5}, 
  {"codigo":"3031","nombre":"Resistencia de materiales 1","creditos":5,"prereq":["3022","3025"],"semestre":5}, 
  {"codigo":"3171","nombre":"Materiales de costrucción 1","creditos":6,"prereq":["3167"],"semestre":5}, 
  {"codigo":"3172","nombre":"Mecánica de fluidos","creditos":5,"prereq":["3021","3025"],"semestre":5}, 
  {"codigo":"3028","nombre":"Matemática aplicada 1","creditos":5,"prereq":["3021","3022"],"semestre":5}, 
  {"codigo":"3173","nombre":"Geología estructural","creditos":3,"prereq":["3167"],"semestre":5}, 
  {"codigo":"3174","nombre":"Geofísica","creditos":3,"prereq":["3022","3167"],"semestre":5}, 
  {"codigo":"3175","nombre":"Perforación de pozos 1","creditos":4,"prereq":["3022","3169"],"semestre":5}, 
  {"codigo":"3176","nombre":"Petrologia","creditos":4,"prereq":["3167"],"semestre":5},
  {"codigo":"3177","nombre":"Geología del petróleo","creditos":4,"prereq":["3167"],"semestre":5},
  
  {"codigo":"3178","nombre":"Topografía 3","creditos":6,"prereq":["3170","3028"],"semestre":6}, 
  {"codigo":"3040","nombre":"Resistencia de materiales 2","creditos":5,"prereq":["3031"],"semestre":6}, 
  {"codigo":"3179","nombre":"Instalaciones eléctricas (civil)","creditos":4,"prereq":["3006","3162","3007"],"semestre":6},
  {"codigo":"3180","nombre":"materiales de costrucción 2","creditos":7,"prereq":["3171","3031"],"semestre":6}, 
  {"codigo":"3181","nombre":"Mecánica de suelos 1","creditos":5,"prereq":["3031","3167"],"semestre":6}, 
  {"codigo":"3182","nombre":"Hidráulica","creditos":5,"prereq":["3172"],"semestre":6}, 
  {"codigo":"3183","nombre":"Ingeniería económica 1","creditos":4,"prereq":["3028"],"semestre":6}, 
  {"codigo":"3184","nombre":"Psícologia Industrial","creditos":3,"prereq":["3090"],"semestre":6}, 
  {"codigo":"3185","nombre":"Legislación 2","creditos":3,"prereq":["3090"],"semestre":6}, 
  {"codigo":"3099","nombre":"Ingeniería de costos","creditos":4,"prereq":["3090"],"semestre":6}, 
  
  {"codigo":"3186","nombre":"Vías terrestres 1","creditos":6,"prereq":["3181","3170"],"semestre":7}, 
  {"codigo":"3187","nombre":"análisis estructural","creditos":5,"prereq":["3040"],"semestre":7},
  {"codigo":"3188","nombre":"Concreto armado 1","creditos":5,"prereq":["3040","3180"],"semestre":7}, 
  {"codigo":"3189","nombre":"Hidrología","creditos":6,"prereq":["3090","3182","3170"],"semestre":7},
  {"codigo":"3190","nombre":"Hidráulica de canles","creditos":4,"prereq":["3182"],"semestre":7}, 
  {"codigo":"3191","nombre":"Máquinas hidráulicas","creditos":6,"prereq":["3182"],"semestre":7}, 
  {"codigo":"3192","nombre":"Ingeniería Económica 2","creditos":4,"prereq":["3183"],"semestre":7}, 
  {"codigo":"3193","nombre":"Administración de recursos humanos","creditos":6,"prereq":["3184"],"semestre":7}, 
  {"codigo":"3194","nombre":"Prácticas intermedias","creditos":0,"prereq":["3180","3164"],"semestre":7}, 
  
  {"codigo":"3195","nombre":"Vías terrestres 2","creditos":4,"prereq":["3186","3188"],"semestre":8}, 
  {"codigo":"3196","nombre":"Tipología estructural","creditos":3,"prereq":["3031"],"semestre":8}, 
  {"codigo":"3197","nombre":"Concreto armado 2","creditos":5,"prereq":["3188"],"semestre":8}, 
  {"codigo":"3198","nombre":"Cimentanciones 1","creditos":4,"prereq":["3187","3188"],"semestre":8}, 
  {"codigo":"3199","nombre":"Aguas subterraneas","creditos":3,"prereq":["3189"],"semestre":8}, 
  {"codigo":"3200","nombre":"Introducción al estudio de impacto ambiental","creditos":4,"prereq":["3011","3183","3163","3189"],"semestre":8}, 
  {"codigo":"3201","nombre":"Análisis mecánico","creditos":5,"prereq":["3025","3187"],"semestre":8}, 
  {"codigo":"3202","nombre":"Ingeniería Sanitaria 1","creditos":4,"prereq":["3189"],"semestre":8}, 
  {"codigo":"3203","nombre":"Ingeniería Sanitaria 2","creditos":4,"prereq":["3189"],"semestre":8}, 
  {"codigo":"3204","nombre":"Investigación 1","creditos":4,"prereq":["3194","3189","3187","3186"],"semestre":8},
  {"codigo":"3205","nombre":"Fundamentos de administración","creditos":4,"prereq":["3193"],"semestre":8},
  
  {"codigo":"3206","nombre":"Pavimentos","creditos":4,"prereq":["3171","3181","3195"],"semestre":9}, 
  {"codigo":"3207","nombre":"Ingeniería de tránsito y transportes","creditos":4,"prereq":["3186"],"semestre":9}, 
  {"codigo":"3208","nombre":"Diseño estructural 1","creditos":6,"prereq":["3187","3197"],"semestre":9}, 
  {"codigo":"3209","nombre":"Cimentaciones 2","creditos":4,"prereq":["3198"],"semestre":9}, 
  {"codigo":"3210","nombre":"Obras hidráulicas","creditos":4,"prereq":["3198","3190"],"semestre":9}, 
  {"codigo":"3211","nombre":"Preparación y evaluación de proyectos","creditos":5,"prereq":["3183","3200"],"semestre":9},
  {"codigo":"3212","nombre":"Saneamiento Ambiental","creditos":3,"prereq":["3202","3203"],"semestre":9}, 
  {"codigo":"3213","nombre":"Gestión de desastres","creditos":4,"prereq":["3200"],"semestre":9}, 
  
  {"codigo":"3214","nombre":"Puentes","creditos":5,"prereq":["3208","3209"],"semestre":10}, 
  {"codigo":"3215","nombre":"Diseño estructural 2","creditos":6,"prereq":["3208"],"semestre":10}, 
  {"codigo":"3216","nombre":"Métodos de construcción y supervisión de obras","creditos":4,"prereq":["3208"],"semestre":10}, 
  {"codigo":"3217","nombre":"Urbanismo","creditos":4,"prereq":["3211"],"semestre":10}, 
  {"codigo":"3218","nombre":"Planeamiento","creditos":4,"prereq":["3211"],"semestre":10}, 
  {"codigo":"3219","nombre":"Costos, presupuestos y avalúos":5,"prereq":["3208","3209","3206"],"semestre":10}, 
  {"codigo":"3220","nombre":"Gestión de proyectos","creditos":4,"prereq":["3211"],"semestre":10}, 
  {"codigo":"3221","nombre":"Prácticas finales de Ingeniería Civil","creditos":0,"prereq":["3208","3209","3194"],"semestre":10},
  {"codigo":"3222","nombre":"Seminario de Investigación EPS, Civil","creditos":3,"prereq":["3212","3204"],"semestre":10}, 
  {"codigo":"3223","nombre":"Seminario de Investigación Civil","creditos":3,"prereq":["3212","3204"],"semestre":10}
];

/* ===== MEMORIA SEGURA ===== */
let aprobados = new Set();
try{
  const guardados = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  const codigosValidos = new Set(cursos.map(c=>c.codigo));
  guardados.forEach(c => codigosValidos.has(c) && aprobados.add(c));
}catch{
  localStorage.removeItem(STORAGE_KEY);
}

/* ===== CREDITOS TOTALES ===== */
const totalCreditos = cursos.reduce((s,c)=>s+c.creditos,0);
document.getElementById("totales").textContent = totalCreditos;

function puedeLlevar(c){
  return c.prereq.every(p => aprobados.has(p));
}

function render(){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  let suma = 0;

  const semestres = [...new Set(cursos.map(c=>c.semestre))].sort((a,b)=>a-b);

  semestres.forEach(sem=>{
    const col = document.createElement("div");
    col.className = "sem";
    col.innerHTML = `<h3>Semestre ${sem}</h3>`;

    cursos.filter(c=>c.semestre===sem).forEach(c=>{
      let estado = "bloqueado";
      if (aprobados.has(c.codigo)) estado = "aprobado";
      else if (puedeLlevar(c)) estado = "disponible";

      const div = document.createElement("div");
      div.className = `course ${estado}`;
      div.innerHTML = `
        <strong>${c.codigo}</strong> ${c.nombre}
        <div class="meta">
          <span>${c.creditos} cr</span>
          ${obligatorios.has(c.codigo)?'<span class="badge">⭐</span>':''}
        </div>
      `;

      if (estado !== "bloqueado") {
        div.onclick = () => {
          aprobados.has(c.codigo) ? aprobados.delete(c.codigo) : aprobados.add(c.codigo);
          localStorage.setItem(STORAGE_KEY, JSON.stringify([...aprobados]));
          render();
        };
      }

      if (aprobados.has(c.codigo)) suma += c.creditos;
      col.appendChild(div);
    });

    grid.appendChild(col);
  });

  document.getElementById("aprobados").textContent = suma;
}

render();
</script>

</body>
</html>
